import pandas as pd;import os;import re

os.chdir("e:\\auditor")
bo=pd.read_excel("bo.xls",usecols="A:I,K,L,N:P",na_filter=False).drop([0])
ta=pd.read_csv("ta.csv",na_filter=False)



bo.columns=["id","mail","name","nick","worked","audit","reaudit","audited","af","dispute","disputeRate","workedTime","workedTimeMean","workedTimeBasis"]
ta.columns=["id","name","mail","nick","phone","auditor"]
bo,ta=(z.dropna(axis=0,inplace=False).set_index("id") for z in (bo,ta))
ta=ta[["mail","name","nick","phone","auditor"]]

for x in range(len(bo.index)):
    for y in (bo.workedTime,bo.workedTimeMean):
        y.iloc[x]=re.findall(r"\((\d+.\d+).\)",y.iloc[x])[0]

ta.drop(ta.auditor.index[ta.auditor!="O"],inplace=True)
ta.index,bo.index=[z.index.map(int) for z in [ta,bo]]
[z.reset_index() for z in [ta,bo]]
ta=ta.merge(bo,left_on=["id","mail","nick","name"],right_on=["id","mail","nick","name"])

ta[ta.columns[(list(ta.columns)).(index["worked"]):]].applymap(float)
???????????????????????????????cssssssscscxczxc???????????????????????????????????????????????????????
????????????????????????????????????????????????????vvvvvvvvvvvvvvvvvvvvvvv??????????????????????????????????

to_excel("tabo.xlsx",index=False)
